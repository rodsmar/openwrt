From 4efdf548d28d3afbc367e2cbe365107db1869690 Mon Sep 17 00:00:00 2001
From: Peter Chiu <chui-hao.chiu@mediatek.com>
Date: Wed, 16 Oct 2024 08:41:49 +0800
Subject: [PATCH] mtk: mt76: do not report ACK when TXS is lost

Signed-off-by: Shayne Chen <shayne.chen@mediatek.com>
---
 tx.c | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

--- a/tx.c
+++ b/tx.c
@@ -101,7 +101,7 @@ __mt76_tx_status_skb_done(struct mt76_de
 
 	/* Tx status can be unreliable. if it fails, mark the frame as ACKed */
 	if (flags & MT_TX_CB_TXS_FAILED &&
-	    (dev->drv->drv_flags & MT_DRV_IGNORE_TXS_FAILED)) {
+	    (dev->drv->drv_flags & MT_DRV_SW_RX_AIRTIME)) { /* Only CE chips do so */
 		info->status.rates[0].count = 0;
 		info->status.rates[0].idx = -1;
 		info->flags |= IEEE80211_TX_STAT_ACK;
